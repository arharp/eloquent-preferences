language: php

php:
  - "5.5"
  - "5.6"
  - "7.0"
  - "7.1"
  - "7.2"
  - "7.3"

env:
  - LARAVEL_VERSION="5.0.*"
  - LARAVEL_VERSION="5.1.*"
  - LARAVEL_VERSION="5.2.*"
  - LARAVEL_VERSION="5.3.*"
  - LARAVEL_VERSION="5.4.*"
  - LARAVEL_VERSION="5.5.*"
  - LARAVEL_VERSION="5.6.*"
  - LARAVEL_VERSION="5.7.*"
  - LARAVEL_VERSION="5.8.*"

matrix:
  exclude:
    # Laravel 5.3+ requires PHP 5.6+
    - php: "5.5"
      env: LARAVEL_VERSION="5.3.*"
    - php: "5.5"
      env: LARAVEL_VERSION="5.4.*"
    - php: "5.5"
      env: LARAVEL_VERSION="5.5.*"
    - php: "5.5"
      env: LARAVEL_VERSION="5.6.*"
    - php: "5.5"
      env: LARAVEL_VERSION="5.7.*"
    - php: "5.5"
      env: LARAVEL_VERSION="5.8.*"
    # Laravel 5.5+ requires PHP 7.0+
    - php: "5.6"
      env: LARAVEL_VERSION="5.5.*"
    - php: "5.6"
      env: LARAVEL_VERSION="5.6.*"
    - php: "5.6"
      env: LARAVEL_VERSION="5.7.*"
    - php: "5.6"
      env: LARAVEL_VERSION="5.8.*"
    # Laravel 5.6+ requires PHP 7.1+
    - php: "7.0"
      env: LARAVEL_VERSION="5.6.*"
    - php: "7.0"
      env: LARAVEL_VERSION="5.7.*"
    - php: "7.0"
      env: LARAVEL_VERSION="5.8.*"

before_script:
  - composer install --dev
  - composer remove --update-with-dependencies illuminate/database illuminate/support
  - composer remove --dev --update-with-dependencies illuminate/events
  - composer require illuminate/database:${LARAVEL_VERSION} illuminate/support:${LARAVEL_VERSION}
  - composer require --dev illuminate/events:${LARAVEL_VERSION}

script:
  - vendor/bin/phpunit
